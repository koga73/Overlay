/*
* Overlay v1.2.1 Copyright (c) 2015 AJ Savino
* https://github.com/koga73/Overlay
* MIT LICENSE
*/
var Overlay=function(){var e,t={EVENT_BEFORE_SHOW:"beforeshow",EVENT_AFTER_SHOW:"aftershow",EVENT_BEFORE_HIDE:"beforehide",EVENT_AFTER_HIDE:"afterhide"},n={ID_CONTAINER:"overlayContainer",ID_BACKGROUND:"overlayBackground",ID_FRAME:"overlayFrame",ID_CLOSE:"overlayClose",CLASS_FRAME_VISIBLE:"visible",CLASS_BODY_OVERLAY_VISIBLE:"overlay-visible"},r={container:document.body,_container:null,_background:null,_content:null,_frame:null,_close:null,_showCallback:null,_hideCallback:null},a={initialize:function(){var e=document.createElement("div");e.setAttribute("id",n.ID_CONTAINER),r._container=e;var t=document.createElement("div");t.setAttribute("id",n.ID_BACKGROUND),r._background=t;var a=document.createElement("div");a.setAttribute("id",n.ID_FRAME),r._frame=a;var i=document.createElement("button");i.setAttribute("id",n.ID_CLOSE),i.setAttribute("type","button"),r._close=i,a.appendChild(i),e.appendChild(t),e.appendChild(a)},destroy:function(){o.removeClass(document.body,n.CLASS_BODY_OVERLAY_VISIBLE);var e=r._close;e&&OOP.removeEventListener(e,"click",a._handler_close_clicked),r._close=null,r._frame=null;var t=r._content;t&&(t.parentNode.removeChild(t),"undefined"!=typeof t._overlayData.width&&(t.style.width=""),"undefined"!=typeof t._overlayData.height&&(t.style.height=""),"undefined"!=typeof t._overlayData.parent&&t._overlayData.parent.appendChild(t),t._overlayData=null),r._content=null;var i=r._background;i&&OOP.removeEventListener(i,"click",a._handler_background_click),r._background=null;var d=r._container;d&&d.parentNode&&(d.setAttribute("class",""),d.parentNode.removeChild(d)),r._container=null,r._showCallback=null,r._hideCallback=null},show:function(t,d,l){if(r._showCallback=l,o.addClass(document.body,n.CLASS_BODY_OVERLAY_VISIBLE),OOP.dispatchEvent(e,new OOP.Event(e.EVENT_BEFORE_SHOW)),null!=r._content)return void e.hide(function(){e.show(t,d,l)});var s,_,v,c,u="";"undefined"!=typeof d&&("undefined"!=typeof d.width&&(s=d.width),"undefined"!=typeof d.height&&(_=d.height),"undefined"!=typeof d.offsetX&&(v=d.offsetX),"undefined"!=typeof d.offsetY&&(c=d.offsetY),"undefined"!=typeof d.containerClass&&(u=d.containerClass));var E=r._container,f=r._background,h=r._frame,p=r._close,y=document.getElementById(t);y._overlayData=y._overlayData||{},"undefined"==typeof s&&(s="undefined"!=typeof document.documentElement.currentStyle?y.currentStyle.width:window.getComputedStyle(y).width),parseInt(s)?(h.style.width=s,y._overlayData.width=s,y.style.width="100%"):h.style.width="","undefined"==typeof _&&(_="undefined"!=typeof document.documentElement.currentStyle?y.currentStyle.height:window.getComputedStyle(y).height),parseInt(_)?(h.style.height=_,y._overlayData.height=_,y.style.height="100%"):h.style.height="",h.style.left="undefined"!=typeof v?v:"",h.style.top="undefined"!=typeof c?c:"",r._content=y,OOP.addEventListener(f,"click",a._handler_background_click),OOP.addEventListener(p,"click",a._handler_close_clicked),y._overlayData.parent=y.parentNode,y.parentNode.removeChild(y),h.appendChild(y);var m=e.container;e.container.length&&(m=e.container[0]),m.appendChild(E),o.addClass(E,u);var O=setTimeout(function(){clearTimeout(O),o.addClass(E,n.CLASS_FRAME_VISIBLE)},50);i.hasTransition(f)||i.hasTransition(h)?(i.offTransitionComplete(E),i.onTransitionComplete(E,a._handler_show_complete)):a._handler_show_complete()},hide:function(t){r._hideCallback=t,OOP.dispatchEvent(e,new OOP.Event(e.EVENT_BEFORE_HIDE));var d=r._close;d&&OOP.removeEventListener(d,"click",a._handler_close_clicked);var l=r._background;l&&OOP.removeEventListener(l,"click",a._handler_background_click);var s=r._frame,_=r._container;_&&(i.hasTransition(l)||i.hasTransition(s)?(i.offTransitionComplete(_),i.onTransitionComplete(_,a._handler_hide_complete)):a._handler_hide_complete(),o.removeClass(_,n.CLASS_FRAME_VISIBLE))},_handler_show_complete:function(){i.offTransitionComplete(r._container),OOP.dispatchEvent(e,new OOP.Event(e.EVENT_AFTER_SHOW));var t=r._showCallback;"undefined"!=typeof t&&(t(),r._showCallback=null)},_handler_hide_complete:function(){var t=r._container;i.offTransitionComplete(t);var a=r._content;a&&(a.parentNode.removeChild(a),"undefined"!=typeof a._overlayData.width&&(a.style.width=""),"undefined"!=typeof a._overlayData.height&&(a.style.height=""),"undefined"!=typeof a._overlayData.parent&&a._overlayData.parent.appendChild(a),a._overlayData=null),r._content=null,t.setAttribute("class",""),t.parentNode.removeChild(t),o.removeClass(document.body,n.CLASS_BODY_OVERLAY_VISIBLE),OOP.dispatchEvent(e,new OOP.Event(e.EVENT_AFTER_HIDE));var d=r._hideCallback;"undefined"!=typeof d&&(d(),r._hideCallback=null)},_handler_close_clicked:function(){return e.hide(),!1},_handler_background_click:function(){return e.hide(),!1}},i=function(){for(var e=null,t=null,n=[["webkitTransition","webkitTransitionEnd","-webkit-"],["transition","transitionend",""]],r=n.length,a=0;r>a&&"undefined"==typeof document.documentElement.style[n[a][0]];a++);return a!=r&&(e=n[a][1],t=n[a][2]),{hasTransition:function(e){return"undefined"!=typeof document.documentElement.currentStyle?parseFloat(e.currentStyle[t+"transition-duration"])>0:parseFloat(window.getComputedStyle(e)[t+"transition-duration"])>0},onTransitionComplete:function(t,n){e?OOP.addEventListener(t,e,n):n()},offTransitionComplete:function(t,n){e&&("undefined"!=typeof n?OOP.removeEventListener(t,e,n):OOP.removeEventListener(t,e))}}}(),o=function(){return"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),{addClass:function(e,t){var n=(e.getAttribute("class")||"").split(" ");t=t.split(" ");for(var r in t)n.push(t[r].trim());e.setAttribute("class",n.join(" ").trim())},removeClass:function(e,t){var n=(e.getAttribute("class")||"").split(" ");t=t.split(" ");for(var r in t)for(var a=n.length,i=0;a>i;i++)n[i]==t[r].trim()&&(n.splice(i,1),a--,i--);e.setAttribute("class",n.join(" ").trim())},hasClass:function(e,t){var n=(e.getAttribute("class")||"").split(" ");t=t.split(" ");var r=0;for(var a in t)for(var i=n.length,o=0;i>o;o++)if(n[o]==t[a].trim()){r++;break}return r==t.length?!0:!1}}}();return e={EVENT_BEFORE_SHOW:t.EVENT_BEFORE_SHOW,EVENT_AFTER_SHOW:t.EVENT_AFTER_SHOW,EVENT_BEFORE_HIDE:t.EVENT_BEFORE_HIDE,EVENT_AFTER_HIDE:t.EVENT_AFTER_HIDE,container:r.container,initialize:a.initialize,destroy:a.destroy,hide:a.hide,show:a.show}}();if(!OOP)var OOP=function(){var e={event:function(e,t){var n=null;try{n=new CustomEvent(e)}catch(r){document.createEventObject?(n=document.createEventObject("Event"),n.initCustomEvent&&n.initCustomEvent(e,!0,!0)):n={}}return n._type=e,n._data=t,n},addEventListener:function(t,n,r){t._eventHandlers||(t._eventHandlers={}),n=n.split(",");for(var a=n.length,i=0;a>i;i++){var o=n[i];if(t.addEventListener)r=e._addEventHandler(t,o,r),t.addEventListener(o,r);else if(t.attachEvent){var d=function(){r(window.event)};d.handler=r,d=e._addEventHandler(t,o,d),t.attachEvent("on"+o,d)}else"undefined"!=typeof jQuery?(r=e._addEventHandler(t,o,r),jQuery.on(o,r)):(t.addEventListener=e._addEventListener,t.addEventListener(o,r))}},_addEventListener:function(t,n){n._isCustom=!0,e._addEventHandler(this,t,n)},_addEventHandler:function(e,t,n){e._eventHandlers[t]||(e._eventHandlers[t]=[]);for(var r=e._eventHandlers[t],a=r.length,i=0;a>i;i++){if(r[i]===n)return n;if(r[i].handler&&r[i].handler===n)return r[i]}return r.push(n),n},removeEventListener:function(t,n,r){t._eventHandlers||(t._eventHandlers={}),n=n.split(",");for(var a=n.length,i=0;a>i;i++){var o,d=n[i];o="undefined"==typeof r?t._eventHandlers[d]||[]:[r];for(var l=o.length,s=0;l>s;s++){var r=o[s];t.removeEventListener?(r=e._removeEventHandler(t,d,r),t.removeEventListener(d,r)):t.detachEvent?(r=e._removeEventHandler(t,d,r),t.detachEvent("on"+d,r)):"undefined"!=typeof jQuery?(r=e._removeEventHandler(t,d,r),jQuery.off(d,r)):(t.removeEventListener=e._removeEventListener,t.removeEventListener(d,r))}}},_removeEventListener:function(t,n){t=t.split(",");for(var r=t.length,a=0;r>a;a++){var i,o=t[a];i="undefined"==typeof n?this._eventHandlers[o]||[]:[n];for(var d=i.length,l=0;d>l;l++){var n=i[l];n._isCustom=!1,e._removeEventHandler(this,o,n)}}},_removeEventHandler:function(e,t,n){e._eventHandlers[t]||(e._eventHandlers[t]=[]);for(var r=e._eventHandlers[t],a=r.length,i=0;a>i;i++){if(r[i]===n)return r.splice(i,1)[0];if(r[i].handler&&r[i].handler===n)return r.splice(i,1)[0]}},dispatchEvent:function(t,n){t._eventHandlers||(t._eventHandlers={}),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent?t.fireEvent("on"+type,n):"undefined"!=typeof jQuery?jQuery(t).trigger(jQuery.Event(n._type,{_type:n._type,_data:n._data})):(t.dispatchEvent=e._dispatchEvent,t.dispatchEvent(n))},_dispatchEvent:function(t){e._dispatchEventHandlers(this,t)},_dispatchEventHandlers:function(e,t){var n=e._eventHandlers[t._type];if(n)for(var r=n.length,a=0;r>a;a++)n[a](t)}};return{Event:e.event,addEventListener:e.addEventListener,removeEventListener:e.removeEventListener,dispatchEvent:e.dispatchEvent}}();Overlay.initialize();